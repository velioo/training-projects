tinymce.PluginManager.add("base64image",function(e,t){var i=e.getParam("max_image_count")||10,n=e.getParam("max_image_size")||512e3,a=e.getParam("max_image_size")||1024,s=e.getParam("max_image_size")||1024;ASSERT.isNumber(i,{code:6e3,msg:"TinyMCE base64: imageCountLimit $PARAM$ must be a number",msgParams:{PARAM:i}}),ASSERT.isNumber(n,{code:6010,msg:"TinyMCE base64: imageSizeLimit $PARAM$ must be a number",msgParams:{PARAM:n}}),ASSERT.isNumber(a,{code:6020,msg:"TinyMCE base64: imageHeightLimit $PARAM$ must be a number",msgParams:{PARAM:a}}),ASSERT.isNumber(s,{code:6030,msg:"TinyMCE base64: imageWidthLimit $PARAM$ must be a number",msgParams:{PARAM:s}});var r=function(t){if(window.File&&window.FileReader&&window.FileList&&window.Blob){for(var r,o=document.getElementsByName("tb-jf-tinymce-base64-img")[0].files,m=new FileReader,g=0;r=o[g];g++)var p=r.size;if(this.parent()&&this.parent().parent())var c=this.parent().parent();if(p>n)return e.windowManager.open({title:"Error: fileSizee exceeds limits",width:450,height:80,html:'<p style="font-size:14px;padding:30px;">The image is too big. It must be 500KB or less.</p>',buttons:[{text:"OK",onclick:function(){this.parent()&&this.parent().parent()&&this.parent().parent().close()}}]}),void c.close();if($(e.getBody()).find("img").length>=i)return e.windowManager.open({title:"Error: too many images",width:450,height:80,html:'<p style="font-size:14px;padding:30px;">The number of images in the editor cannot be higher than '+i+". Please delete an image and try again.</p>",buttons:[{text:"OK",onclick:function(){this.parent()&&this.parent().parent()&&this.parent().parent().close()}}]}),void c.close();m.onload=function(i){if(!(p>n)){var r=i.target.result,o=new Image;if(o.src=r,o.height>a||o.width>s)e.windowManager.open({title:"Error: dimensions exceed limits",width:450,height:80,html:'<p style="font-size:14px;padding:30px;">The image cannot be more than '+s+" pixels wide or "+a+" pixels high.</p>",buttons:[{text:"OK",onclick:function(){this.parent()&&this.parent().parent()&&this.parent().parent().close()}}]}),c.close();else if(t){e.dom.getRoot();var m=e.getContent({format:"raw"}),g=document.createElement("div");g.innerHTML=m,g.querySelector(".tb-jf-tinymce-base64-img-bg")&&(m=g.querySelector(".tb-jf-tinymce-base64-img-bg").innerHTML);var d='<div class="tb-jf-tinymce-base64-img-bg" style="'+("background-image: url('"+r+"');background-repeat: no-repeat; background-position: top center;")+'">'+m+"</div>";e.setContent(""),e.execCommand("mceReplaceContent",!1,d)}else e.execCommand("mceInsertContent",!1,"<img src='"+r+"' />")}},m.onerror=function(e){ASSERT.isDefined(e,{code:6040,msg:"TinyMCE error: $MESSAGE$",msgParams:{MESSAGE:e.getMessage()}})},o.length>0?m.readAsDataURL(o[0]):e.windowManager.open({title:"Error: no file selected",width:450,height:80,html:'<p style="font-size:14px;padding:30px;">Please select a file before clicking the insert button.</p>',buttons:[{text:"OK",onclick:function(){this.parent()&&this.parent().parent()&&this.parent().parent().close()}}]})}else e.windowManager.open({title:"Error: unsupported browser",width:450,height:80,html:'<p style="font-size:14px;padding:30px;">Please use a modern browser.</p>',buttons:[{text:"OK",onclick:function(){this.parent()&&this.parent().parent()&&this.parent().parent().close()}}]});this.parent()&&this.parent().parent()&&this.parent().parent().close()};e.addCommand("base64image",function(){e.windowManager.open({title:"Insert embedded image",width:450,height:80,html:'<input type="file" class="input" name="tb-jf-tinymce-base64-img" style="font-size:14px;padding:30px;" accept="image/png, image/gif, image/jpeg, image/jpg"/>',buttons:[{text:"Insert as image",subtype:"primary",onclick:function(){r.call(this,!1)}},{text:"Insert as background",subtype:"primary",onclick:function(){r.call(this,!0)}},{text:"Cancel",onclick:function(){this.parent()&&this.parent().parent()&&this.parent().parent().close()}}]})}),e.addButton("base64image",{cmd:"base64image",icon:"image",context:"insert",title:"Insert embedded image"}),e.addMenuItem("base64image",{cmd:"base64image",context:"insert",text:"Insert embedded image",icon:"image",prependToContext:!0})});