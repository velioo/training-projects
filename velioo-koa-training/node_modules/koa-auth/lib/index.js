var Auth = require('./lib/auth')
  , Provider = require('./lib/provider')
  , koa = require('koa');



module.exports.Provider = function(cfg) {
  return new Provider(cfg);
};

/**
 * This adds the authentication object to the
 * @param {Provider} provider - The Authentication Provider Instance
 */
module.exports.Middleware = function(provider) {
  var app = new koa();

  app.use(function *(next) {
    this.auth = new Auth(provider, this);
    yield next;
  });

  return app;

};
